machine:
  services:
    - docker
  environment:
    GCLOUD_PROJECT: "eve-notifications"
    DOCKER_IMAGE_NAME: "en-rss"
    CLUSTER_NAME: "eve-notifications"
    GCLOUD_ZONE: "europe-west1-d"

dependencies:
  pre:
    - ./ensure-kubernetes-installed.sh
    - ./setup-gcloud.sh

deployment:
  gcr.io:
    branch: master
    commands:
      - ./docker-push.sh

  release:
    tag: /release-.*/
    commands:
      - echo $CIRCLE_SHA1
      - docker images
      - ./kubernetes/cluster/kubectl.sh get po
